# 04. 역할, 책임, 협력

## 책임의 분류

협력에 참여하는 객체들은 목표를 달성하는 데 필요한 책임을 수행한다. 책임은 객체에 의해 정의되는 응집도 있는 `행동의 집합`으로, 객체가 수행할 수 있는 행위에 대해 서술한 문장이다. 결국 객체의 책임은 `객체가 무엇을 알고 있는가 (knowing)`와 `무엇을 할 수 있는가 (doing)`로 구성된다. 책임은 객체지향 설계의 품질을 결정하는 가장 중요한 요소기 때문에 객체에게 명확한 책임을 할당하는 것이 중요하다.

객체의 책임은 일반적으로 외부에서 접근 가능한 공용 서비스의 관점에서 이야기할 수 있다. 책임은 객체의 외부에 제공해 줄 수 있는 `정보 (아는 것의 측면)`와 외부에 제공해 줄 수 있는 `서비스 (하는 것의 측면)`의 목록이다. 따라서 책임은 객체의 `공용 인터페이스 (public interface)`를 구성한다.

## 책임과 메시지

책임이 협력이라는 문맥 속에서 요청을 수신하는 한 쪽의 객체 관점에서 무엇을 할 수 있는지를 나열하는 것이라면 메시지는 협력에 참여하는 두 객체 사이의 관계를 강조한 것이다.

책임과 메시지의 수준이 같은 것은 아니다. 책임은 객체가 협력에 참여하기 위해 수행해야 하는 행위를 상위 수준에서 개략적으로 서술한 것이다. 책임을 결정한 후 실제로 협력을 정제하면서 이를 메시지로 변환할 때는 하나의 책임이 여러 메시지로 분할되는 것이 일반적이다.

## 책임의 집합, 역할

앞서 책임과 역할에 대해 여러 번 설명하였다. 그러나 둘의 차이가 여전히 모호하게 느껴질 수 있기에 이번에 확실하게 짚고 넘어간다. 앨리스의 예시로 살펴보자. 모자 장수가 재판이라는 협력 안에서 `증인석에 입장한다`와 `증언한다`라는 책임을 가진다는 것은, 모자 장수가 재판이라는 협력에 참여하기 위해 `증인`이라는 역할을 수행하고 있음을 의미한다. 왕이 `재판한다`는 책임을 지고 하얀 토끼에게 목격자를 불러오도록 요청한 후 증언하도록 요구한다는 것은, 왕이 `판사`라는 역할을 수행하고 있음을 의미한다. 결론적으로 어떤 객체가 수행하는 책임의 집합은 객체가 협력 안에서 수행하는 `역할`을 암시한다.

이것이 왜 중요한 것이냐고 반문할 수 있다. 왕은 왕일 뿐이고 모자 장수는 모자 장수일 뿐이라고 생각할 수 있다. 굳이 왕을 판사라고 부르고 모자 장수를 증인이라고 불러야될 필요는 무엇일까? 그것은 `역할`이 재사용 가능하고 유연한 객체지향 설계를 낳는 중요한 구성요소이기 때문이다. 위 예시에서 `증인석에 입장한다`와 `증언한다`라는 책임의 주체가 모자 장수에서 앨리스로, `재판한다`는 책임의 주체가 왕에서 여왕으로 변한 상황을 생각해보면 쉽게 이해할 수 있다.

역할은 협력 내에서 다른 객체로 `대체할 수 있음`을 나타내는 일종의 표식이다. 협력 안에서 역할은 `이 자리는 해당 역할을 수행할 수 있는 어떤 객체라도 대신할 수 있다`고 말하는 것과 같다. 역할을 이용해 `협력을 추상화`하면 해당 역할을 수행할 수 있는 어떤 객체라도 협력에 참여할 수 있다. 앨리스의 이야기에서 `왕-하얀 토끼-모자 장수`의 협력, `왕-하얀 토끼-요리사`의 협력, `여왕-하얀 토끼-앨리스`의 협력은 구체적인 객체를 추상적인 역할로 대체함으로써 `판사-하얀 토끼-증인`이 참여하는 하나의 추상적인 협력으로 대체할 수 있다. 그래서 역할은 객체지향 설계의 `단순성 (simplicity)`, `유연성 (flexibility)`
, `재사용성 (reusability)`을 뒷받침하는 핵심 개념이다.

한편, 객체가 역할에 주어진 책임 이외에 다른 책임을 수행할 수도 있다는 사실을 잊으면 안 된다. 판사의 역할을 수행할 수 있는 왕은 재판을 할 책임뿐만 아니라 국정을 돌봐야 할 추가적인 책임을 가지고 있다. 모자 장수는 증인으로서의 역할뿐만 아니라 모자를 판매할 모자 장수로서의 본질적인 책임을 가지고 있다. 앨리스는 잠시만 증인의 역할을 할 뿐 이야기 내내 주인공으로서의 역할을 해왔다. 결국 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질 수 있다. 일반적으로 역할과 객체의 타입 사이에는 `일반화/특수화 관계`가 성립한다. 좀 더 일반적인 개념을 의미하는 역할은 일반화이며 좀 더 구체적인 개념을 의미하는 개체의 타입은 특수화다.

## 객체지향 설계 기법

역할, 책임, 협력의 관점에서 애플리케이션을 설계하는 유용한 3가지 기법이 있다.

- `책임-주도 설계 (Responsibility-Driven Design)`: 협력에 필요한 책임들을 식별하고 적합한 객체에게 책임을 할당하는 방식으로 애플리케이션을 설계하는 방법이다.

- `디자인 패턴 (Design Pattern)`: 전문가들이 반복적으로 사용하는 해결 방법을 정의해 놓은 설계 템플릿의 모음이다. 패턴은 전문가들이 특정 문제를 해결하기 위해 이미 식별해놓은 역할, 책임, 협력의 모음이다. 패턴을 알고 있다면 바퀴를 반복적으로 발명할 필요가 없다. 우리가 필요로 하는 역할, 책임, 협력이 디자인 패턴 안에 이미 존재하기 때문이다.

- `테스트-주도 개발 (Test-Driven Development)`: 테스트를 먼저 작성하고 테스트를 통과하는 구체적인 코드를 추가하면서 애플리케이션을 완성해나가는 방법이다. 이름에서 풍기는 뉘앙스와 달리 테스트-주도 개발은 테스트가 아니라 설계를 위한 기법이다. 테스트-주도 개발의 핵심은 테스트 작성이 아니다. 테스트는 단지 테스트-주도 개발을 통해 얻을 수 있는 별도의 보너스 같은 것이다. 본질은 구체적인 코드를 작성해나가면서 역할, 책임, 협력을 식별하고 식별된 역할, 책임, 협력이 적합한지를 피드백받는 것이다.
